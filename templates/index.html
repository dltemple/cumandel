<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>Mandelbrot Set Explorer</title>

    <style>
        body {
          margin: 0;
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh;
          background-color: #f0f0f0;
        }
      
        .container {
          position: relative;
          width: 80%;
          height: 80%;
          background-color: #fff;
          border-radius: 5px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        </style>
</head>
<body>
    <h1>Mandelbrot Set Explorer</h1>
    <!-- Add your frontend code here -->
    <h1>Mandelbrot Set Explorer</h1>

    <div class="container">
    <canvas id="mandelbrotCanvas"></canvas>
    </div>

    <script>
    const canvas = document.getElementById('mandelbrotCanvas');
    const ctx = canvas.getContext('2d');

    let width = canvas.width = window.innerWidth;
    let height = canvas.height = window.innerHeight;

    let x_min = -2;
    let x_max = 1;
    let y_min = -1;
    let y_max = 1;
    let max_iterations = 1000;

    function drawMandelbrot() {
        $.ajax({
        url: '/mandelbrot',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({
            width: width,
            height: height,
            x_min: x_min,
            x_max: x_max,
            y_min: y_min,
            y_max: y_max,
            max_iterations: max_iterations
        }),
        success: function (data) {
            const imgData = ctx.createImageData(width, height);
            for (let i = 0; i < data.length; i++) {
            for (let j = 0; j < data[i].length; j++) {
                const idx = (i * width + j) * 4;
                const color = data[i][j];
                imgData.data[idx] = imgData.data[idx + 1] = imgData.data[idx + 2] = color;
                imgData.data[idx + 3] = 255;
            }
            }
            ctx.putImageData(imgData, 0, 0);
        }
        });
    }

    canvas.addEventListener('wheel', function (e) {
        e.preventDefault();
        const scaleFactor = e.deltaY < 0 ? 0.9 : 1.1;
        const mouseX = e.clientX;
        const mouseY = e.clientY;

        const x_range = x_max - x_min;
        const y_range = y_max - y_min;

        x_min += x_range * (1 - scaleFactor) * (mouseX / canvas.width);
        x_max = x_min + x_range * scaleFactor;

        y_min += y_range * (1 - scaleFactor) * (mouseY / canvas.height);
        y_max = y_min + y_range * scaleFactor;

        drawMandelbrot();
    });

    drawMandelbrot();
    </script>
</body>
</html>
